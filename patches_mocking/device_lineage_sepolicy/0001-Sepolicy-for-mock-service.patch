From 3fd1d7bafc0d0562f5e3a3f3939a936cbf32088e Mon Sep 17 00:00:00 2001
From: Lovely_xianxian <xyx_dada@outlook.com>
Date: Mon, 1 Jan 2024 14:20:33 +0800
Subject: [PATCH] Sepolicy for mock service

Change-Id: I0b693bf0c2d996c51f4a3cfdf3d1d0533f4be673
---
 common/private/service.te       | 1 +
 common/private/service_contexts | 1 +
 common/private/system_server.te | 1 +
 3 files changed, 3 insertions(+)

diff --git a/common/private/service.te b/common/private/service.te
index 86f6e4c..1a8d849 100644
--- a/common/private/service.te
+++ b/common/private/service.te
@@ -1,4 +1,5 @@
 type adbroot_service,                   service_manager_type;
+type mock_service,                      app_api_service, ephemeral_app_api_service, system_server_service, service_manager_type;
 type lineage_hardware_service, system_api_service, system_server_service, service_manager_type;
 type lineage_health_interface_service, system_api_service, system_server_service, service_manager_type;
 type lineage_globalactions_service, system_api_service, system_server_service, service_manager_type;
diff --git a/common/private/service_contexts b/common/private/service_contexts
index cd984cb..0b9097b 100644
--- a/common/private/service_contexts
+++ b/common/private/service_contexts
@@ -6,3 +6,4 @@ lineagetrust                              u:object_r:lineage_trust_service:s0
 profile                                   u:object_r:lineage_profile_service:s0
 
 adbroot_service                           u:object_r:adbroot_service:s0
+mock                                      u:object_r:mock_service:s0
diff --git a/common/private/system_server.te b/common/private/system_server.te
index e396fa5..9fad92e 100644
--- a/common/private/system_server.te
+++ b/common/private/system_server.te
@@ -1,6 +1,7 @@
 allow system_server storage_stub_file:dir getattr;
 
 allow system_server adbroot_service:service_manager find;
+allow system_server mock_service:service_manager add;
 
 # Use HALs
 hal_client_domain(system_server, hal_lineage_fastcharge)
-- 
2.42.0

